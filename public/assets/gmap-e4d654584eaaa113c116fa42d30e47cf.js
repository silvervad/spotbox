function gmap_init(){function o(){if(r>1)map.fitBounds(d);else if("country"==m||"new"==m){var o=new google.maps.Geocoder;o.geocode({address:gon.country},function(o,e){e==google.maps.GeocoderStatus.OK&&(map.setCenter(o[0].geometry.location),map.fitBounds(o[0].geometry.viewport),"new"==m&&g.setPosition(o[0].geometry.location))})}else map.setCenter(g.getPosition()),map.setZoom(15)}var e=document.getElementById("button-center-map"),t=[{featureType:"all",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"off"}]}],n=[{featureType:"all",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"on"}]}],a={styles:t,mapTypeId:google.maps.MapTypeId.HYBRID,panControl:!1,scaleControl:!0,rotateControl:!0,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.BOTTOM_LEFT},zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_BOTTOM},streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_BOTTOM}},l={zoom:1,styles:n,mapTypeId:google.maps.MapTypeId.HYBRID,panControl:!1,scaleControl:!0,rotateControl:!0,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.BOTTOM_LEFT},zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_BOTTOM},streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_BOTTOM}},s=gon.markers,i={path:google.maps.SymbolPath.CIRCLE,scale:6,strokeColor:"#003333",strokeOpacity:.8,strokeWeight:2,fillColor:"#00FF99",fillOpacity:1},p={path:google.maps.SymbolPath.CIRCLE,scale:6,strokeColor:"#003333",strokeOpacity:.8,strokeWeight:3,fillColor:"#00FF99",fillOpacity:1},m="none";document.getElementById("country-map-canvas")&&(map=new google.maps.Map(document.getElementById("country-map-canvas"),a),m="country"),document.getElementById("spot-map-canvas")&&(map=new google.maps.Map(document.getElementById("spot-map-canvas"),l),m="spot"),document.getElementById("edit-spot-map-canvas")&&(map=new google.maps.Map(document.getElementById("edit-spot-map-canvas"),l),m="edit"),document.getElementById("new-spot-map-canvas")&&(map=new google.maps.Map(document.getElementById("new-spot-map-canvas"),l),m="new");var g,r,y=new google.maps.InfoWindow,d=new google.maps.LatLngBounds;if(s)for(r=0;r<s.length;r++)myLatLng=new google.maps.LatLng(s[r][1],s[r][2]),g=new google.maps.Marker({position:myLatLng,map:map,icon:i,title:s[r][0]}),d.extend(myLatLng),"edit"==m||"new"==m?(g.setDraggable(!0),lat_field=$("#spot_latitude"),lon_field=$("#spot_longitude"),google.maps.event.addListener(g,"dragend",function(o){lat_field.val(o.latLng.lat()),lon_field.val(o.latLng.lng())}),google.maps.event.addListener(map,"click",function(o){lat_field.val(o.latLng.lat()),lon_field.val(o.latLng.lng()),g.setPosition(o.latLng)})):(google.maps.event.addListener(g,"mouseover",function(o,e){return function(){windowContent="<span class=map-info-window>"+s[e][0]+"</span>",y.setContent(windowContent),y.open(map,o),o.setIcon(p)}}(g,r)),google.maps.event.addListener(g,"mouseout",function(o){return function(){y.close(map,o),o.setIcon(i)}}(g,r)),"country"==m&&google.maps.event.addListener(g,"click",function(o,e){return function(){window.location.href=s[e][3]}}(g,r)));o(),e&&(e.onclick=o)}google.maps.event.addDomListener(window,"load",gmap_init);